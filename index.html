<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/jeromeetienne/ar.js/aframe/build/aframe-ar.min.js"></script>
    <title>AR Монеты</title>
  </head>
  <body style="margin: 0; overflow: hidden;">
    <a-scene embedded arjs>
      <!-- Камера для AR -->
      <a-camera position="0 0 3"></a-camera> <!-- Камера отдалена, чтобы все было видно -->

      <!-- Счетчик очков -->
      <a-text id="scoreText" value="Очки: 0" position="0 2 -3" color="#FFF" scale="3 3 3"></a-text>

      <!-- Статичные монеты (без анимации для начала) -->
      <a-entity id="coin1" geometry="primitive: circle; radius: 0.3;" material="color: red;" position="0 0 -2" class="coin" data-points="-1"></a-entity>
      <a-entity id="coin2" geometry="primitive: circle; radius: 0.3;" material="color: yellow;" position="0.5 0 -2" class="coin" data-points="1"></a-entity>
      <a-entity id="coin3" geometry="primitive: circle; radius: 0.4;" material="color: green;" position="-0.5 0 -2" class="coin" data-points="2"></a-entity>
      <a-entity id="coin4" geometry="primitive: circle; radius: 0.5;" material="color: blue;" position="0 0.5 -2" class="coin" data-points="5"></a-entity>
    </a-scene>

    <script>
      // Подключение Telegram WebApp API
      Telegram.WebApp.ready();

      // Инициализация счётчика очков
      let score = 0;

      // Функция для добавления очков
      function addPoints(coin) {
        const points = parseInt(coin.getAttribute('data-points'));
        score += points;

        const scoreText = document.getElementById('scoreText');
        scoreText.setAttribute('value', `Очки: ${score}`);
      }

      // Функция для добавления монет
      function addCoin() {
        const scene = document.querySelector('a-scene');
        const colors = ['red', 'yellow', 'green', 'blue'];
        const points = [-1, 1, 2, 5];

        const randomIndex = Math.floor(Math.random() * 4);
        const color = colors[randomIndex];
        const point = points[randomIndex];

        const newCoin = document.createElement('a-entity');
        newCoin.setAttribute('geometry', 'primitive: circle; radius: 0.1;');
        newCoin.setAttribute('material', `color: ${color};`);
        newCoin.setAttribute('position', `0 ${Math.random() * 2} -2`); // Позиция новой монеты
        newCoin.setAttribute('data-points', point); // Присваиваем количество очков
        newCoin.classList.add('coin');

        // Добавляем монету в сцену
        scene.appendChild(newCoin);

        // Добавляем обработчик для клика на монету
        newCoin.addEventListener('click', () => addPoints(newCoin));
      }

      // Пример добавления монет каждые 3 секунды
      setInterval(addCoin, 3000); // Добавление монеты каждые 3 секунды
    </script>
  </body>
</html>
