<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/jeromeetienne/ar.js/aframe/build/aframe-ar.min.js"></script>
    <title>GeoAR Объекты</title>
  </head>
  <body style="margin: 0; overflow: hidden;">
    <a-scene
      vr-mode-ui="enabled: false;"
      embedded
      arjs="sourceType: webcam; debugUIEnabled: false;">

      <!-- Камера -->
      <a-camera gps-camera rotation-reader></a-camera>

      <!-- Объект в радиусе 1 метра -->
      <a-entity
        gps-entity-place="latitude: 0; longitude: 0;"
        geometry="primitive: box; height: 1; width: 1; depth: 1;"
        material="color: red;"
        scale="1 1 1">
        <a-text
          value="Красный объект (1 очко)"
          align="center"
          position="0 1.5 0"
          scale="3 3 3">
        </a-text>
      </a-entity>

      <!-- Другой объект в радиусе 1 метра -->
      <a-entity
        gps-entity-place="latitude: 0; longitude: 0;"
        geometry="primitive: sphere; radius: 0.5;"
        material="color: blue;"
        scale="1 1 1">
        <a-text
          value="Синий объект (2 очка)"
          align="center"
          position="0 1.5 0"
          scale="3 3 3">
        </a-text>
      </a-entity>
    </a-scene>

    <script>
      // Определяем местоположение пользователя и обновляем позиции объектов
      navigator.geolocation.getCurrentPosition(
        (position) => {
          const lat = position.coords.latitude;
          const lon = position.coords.longitude;

          // Обновляем позиции объектов
          document.querySelectorAll('[gps-entity-place]').forEach((el, index) => {
            const offset = 0.00001 * (index + 1); // Сдвиг для каждого объекта
            el.setAttribute('gps-entity-place', `latitude: ${lat + offset}; longitude: ${lon + offset}`);
          });
        },
        (error) => {
          console.error('Ошибка определения местоположения:', error);
        },
        { enableHighAccuracy: true }
      );
    </script>
  </body>
</html>
